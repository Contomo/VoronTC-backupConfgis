


[gcode_macro DEBUG_OUTPUT]
description: "evaluate gcode macros/jinja code at runtime for testing."
             "Usage: DEBUG_OUTPUT <HELLO>=\"<action_respond_info('WORLD')>\""
gcode:
    {% set env      = printer.printer.lookup_object('gcode_macro').env %}
    {% set gcode_i  = printer.printer.lookup_object('gcode') %}
    {% for p in params if params %}
        {% set str = params[p] if 'respond' in params[p]|lower or params[p]|length >= 30 else  'RESPOND MSG="' ~ params[p]|pprint ~ '"'%}
        {% set rendered = env.from_string(str).render(self._TemplateReference__context) %}
        {% set _        = gcode_i.run_script_from_command(rendered) if rendered else none %}
        {% set _        = action_respond_info(p) %}
    {% else %}
        {action_respond_info("Usage: DEBUG_OUTPUT <HELLO>=\"<action_respond_info('WORLD')>\"")}
    {% endfor %}
